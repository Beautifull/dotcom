# $Id$
# $URL$

SHELL=/bin/sh
MAILTO="michael@radwin.org"
HEBCAL_WEB=/home/hebcal/web/hebcal.com
HEBCAL_BIN=/home/hebcal/local/bin

# debug
#* * * * * nice touch /tmp/croncheck.hebcal.tmp

0 0 * * * nice $HEBCAL_WEB/bin/cache_cleanup.sh

# monthly cache cleanup
0 0 1 * * mv /tmp/hebcal-cache /tmp/hebcal-cache.$$ && rm -rf /tmp/hebcal-cache.$$

# update static page at the beginning of each month
0 0 1 * * lynx -source 'http://www.hebcal.com/hebcal/?bogus=bogus' | perl -pi -e 's/\?bogus=bogus//g' > $HEBCAL_WEB/hebcal/default.new && mv -f $HEBCAL_WEB/hebcal/default.new $HEBCAL_WEB/hebcal/default.html

# update hebcal.com holiday.inc for front page at midnight
0 0 * * * nice $HEBCAL_WEB/bin/gen_current.pl

# update hebcal.com commentary at 11am on wednesday
11 11 * * 3 touch $HEBCAL_WEB/bin/calc_triennial.pl && sleep 2 && nice make -C $HEBCAL_WEB/bin > /dev/null

# shabbat: regular emails at 2:45am pacific on Thursdays
45 2 * * 4 nice $HEBCAL_BIN/shabbat_weekly.pl -all -verbose

# shabbat: post to Facebook wall on Wednesday between 4:17-4:37pm Pacific
# Sleep a random amount, not greater than 30 minutes
17 16 * * 3 nice $HEBCAL_BIN/post_facebook.pl --shabbat --randsleep=1800

# post to Facebook wall Sunday-Friday between 6:03-6:33am Pacific
3 6 * * 0-5 nice $HEBCAL_BIN/post_facebook.pl --daily --randsleep=1800

# special Rosh Hashana 5771 - 7 Sep 2010 at 1:30am
#30 1 7 9 * nice $HEBCAL_BIN/shabbat_weekly.pl -all -verbose

# clear bounces at 8:03am on friday
3 8 * * 5 nice $HEBCAL_BIN/shabbat_deactivate.pl -count 2

# MySQL backups
30 0 * * * nice $HEBCAL_BIN/email_list_snapshot.sh

# SVN backup
13 0 * * * $HEBCAL_BIN/s3backup.sh

# don't run fetchmail as a daemon, run it from cron
*/6 * * * * /home/hebcal/local/bin/fetchmail -s 2> /dev/null
